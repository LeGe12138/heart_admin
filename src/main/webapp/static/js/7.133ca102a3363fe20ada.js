webpackJsonp([7],{1020:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table"},[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-menu"}),e._v("音乐管理")]),e._v(" "),i("el-breadcrumb-item",[e._v("音乐")])],1)],1),e._v(" "),i("div",{staticClass:"handle-box"},[i("div",{staticClass:"table"},[i("el-form",{ref:"music",staticClass:"demo-admin",attrs:{model:e.music,"label-width":"120px"}},[i("el-form-item",{attrs:{prop:"name",label:"歌名"}},[i("el-input",{attrs:{placeholder:"请输入歌名",disabled:e.disabled},model:{value:e.music.name,callback:function(t){e.$set(e.music,"name",t)},expression:"music.name"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"musician",label:"演唱者"}},[i("el-input",{attrs:{placeholder:"",disabled:e.disabled},model:{value:e.music.musician,callback:function(t){e.$set(e.music,"musician",t)},expression:"music.musician"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"upload_date",label:"上传日期"}},[i("el-input",{attrs:{placeholder:"",disabled:!0},model:{value:e.music.upload_date,callback:function(t){e.$set(e.music,"upload_date",t)},expression:"music.upload_date"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"类型"}},[i("el-select",{attrs:{placeholder:"类型",disabled:e.disabled},on:{change:function(e){}},model:{value:e.music.typeId,callback:function(t){e.$set(e.music,"typeId",t)},expression:"music.typeId"}},e._l(e.typeList,function(t,a){return i("el-option",{key:a,attrs:{label:t.music_label_name,value:t.music_label_id,disabled:e.disabled}})}))],1),e._v(" "),e.addFlag?i("el-form-item",{attrs:{prop:"description",label:"keyword"}},[i("el-input",{attrs:{placeholder:"请输入关键字"},model:{value:e.music.keywords,callback:function(t){e.$set(e.music,"keywords",t)},expression:"music.keywords"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{prop:"description",label:"描述"}},[i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容",disabled:e.disabled},model:{value:e.music.description,callback:function(t){e.$set(e.music,"description",t)},expression:"music.description"}})],1),e._v(" "),e.disabled?i("el-form-item",{attrs:{prop:"play_num",label:"播放次数"}},[i("el-input",{attrs:{placeholder:"",disabled:e.disabled},model:{value:e.music.play_num,callback:function(t){e.$set(e.music,"play_num",e._n(t))},expression:"music.play_num"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{prop:"picture_addr",label:"照片"}},[e.disabled?i("img",{staticStyle:{width:"270px"},attrs:{src:e.music.img_addr}}):i("span",{staticClass:"file",attrs:{href:"javascript:void 0;"}},[e._v("选择文件\n                        "),i("input",{ref:"picture",attrs:{type:"file",name:"img_addr",accept:"image/*",multiple:"multiple"}})])]),e._v(" "),i("el-form-item",{attrs:{prop:"picture_addr",label:"音频"}},[e.disabled?i("audio",{attrs:{src:e.music.save_addr,controls:"controls"}},[e._v("\n                        请升级浏览器\n                    ")]):i("span",{staticClass:"file",attrs:{href:"javascript:void 0;"}},[e._v("选择文件\n                        "),i("input",{ref:"audio",attrs:{type:"file",name:"save_addr",accept:"audio/*",multiple:"multiple"}})])])],1),e._v(" "),e.showEditBtn?i("div",[e.disabled?i("el-button",{staticClass:"right",attrs:{size:"medium",type:"info"},on:{click:function(t){e.disabled=!1}}},[e._v("修改")]):i("el-button",{staticClass:"right",attrs:{size:"medium",type:"info"},on:{click:e.sendArticle}},[e._v("确定")])],1):e._e()],1)])])},staticRenderFns:[]}},1042:function(e,t,i){var a=i(721);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(197)("7937ee5a",a,!0)},515:function(e,t,i){i(1042);var a=i(198)(i(603),i(1020),"data-v-d62988f0",null);e.exports=a.exports},530:function(e,t,i){e.exports={default:i(531),__esModule:!0}},531:function(e,t,i){i(533),e.exports=i(65).Object.keys},532:function(e,t,i){var a=i(88),s=i(65),d=i(59);e.exports=function(e,t){var i=(s.Object||{})[e]||Object[e],r={};r[e]=t(i),a(a.S+a.F*d(function(){i(1)}),"Object",r)}},533:function(e,t,i){var a=i(137),s=i(66);i(532)("keys",function(){return function(e){return s(a(e))}})},603:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(530),s=i.n(a);t.default={name:"add-music",data:function(){return{musicId:this.$route.params.musicId,music:{},typeList:[],disabled:!1,addFlag:!1,showEditBtn:!0}},created:function(){this.getMusicType()},mounted:function(){var e=this;if(e.musicId>0)e.disabled=!0,e.getMusicById(e.musicId);else{var t=new Date;e.music.upload_date=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),e.music.play_num=1,e.addFlag=!0}},methods:{getMusicType:function(){var e=this;e.$axios.post("/mapis/music/getLabels").then(function(t){t.data.state&&(e.typeList=t.data.list)})},getMusicById:function(e){var t=this;t.$axios.post("/mapis/music/getMusicById",{musicId:e}).then(function(e){e.data.state&&(t.music=e.data.list)})},getFormData:function(e,t,i){var a=this;if(s()(a.music).length<e.length)return void a.$message.error("请检查内容，内容都不可为空");for(var d in a.music)if(-1==i.indexOf(d)){if(!a.music[d]||-1==e.indexOf(d))return console.log("err "+d),a.$message.error("请检查内容，内容都不可为空"),!1;t.append(d,a.music[d])}return!0},editMusic:function(){var e=this,t=["music_id","name","musician","typeId","upload_date","description","play_num"],i=["img_addr","save_addr"],a=new FormData;if(e.getFormData(t,a,i)){e.$refs.picture.files[0]?a.append("img_addr",e.$refs.picture.files[0]):a.append("img_addr",e.music.img_addr),e.$refs.audio.files[0]?a.append("save_addr",e.$refs.audio.files[0]):a.append("save_addr",e.music.save_addr);var s={headers:{"Content-Type":"multipart/form-data"}};e.$axios.post("/mapis/music/editMusic",a,s).then(function(t){t.data.state&&(e.getMusicById(e.musicId),e.disabled=!0)})}},addMusic:function(){var e=this,t=["name","musician","typeId","upload_date","description","play_num","keywords"],i=new FormData;if(e.getFormData(t,i,[])){if(!e.$refs.picture.files[0]||!e.$refs.audio.files[0])return void e.$message.error("请检查内容，内容都不可为空");i.append("img_addr",e.$refs.picture.files[0]),i.append("save_addr",e.$refs.audio.files[0]);var a={headers:{"Content-Type":"multipart/form-data"}};e.$axios.post("/mapis/music/addMusic",i,a).then(function(t){t.data.state&&(e.addFlag=!1,e.$router.push({name:"music",params:{musicId:t.data.musicId}}),e.getMusicById(t.data.musicId),e.showEditBtn=!1,e.disabled=!0)})}},sendArticle:function(){var e=this;e.musicId>0?e.editMusic():e.addMusic()}}}},721:function(e,t,i){t=e.exports=i(87)(!1),t.push([e.i,".file[data-v-d62988f0]{position:relative;display:inline-block;background:#20a0ff;border:1px solid #20a0ff;border-radius:4px;padding:4px 15px;overflow:hidden;color:#fff;text-decoration:none;text-indent:0;line-height:20px}.file input[data-v-d62988f0]{position:absolute;font-size:100px;right:0;top:0;opacity:0}.file[data-v-d62988f0]:hover{background:#2085c5;border-color:#2085c5;color:#fff;text-decoration:none}",""])}});